DESAFIO 1:
SELECT ID_VENDEDOR,NOME,SALARIO 
FROM VENDEDORES
ORDER BY NOME ASC

DESAFIO 2:
SELECT id_vendedor, nome, salario
FROM vendedores
WHERE salario > (
    SELECT AVG(salario) FROM vendedores
)
ORDER BY salario DESC;

DESAFIO 3:
SELECT PEDIDO.ID_PEDIDO,
CLIENTES.RAZAO_SOCIAL,
PEDIDO.VALOR_TOTAL
FROM PEDIDO
LEFT JOIN CLIENTES
ON CLIENTES.ID_CLIENTE = PEDIDO.ID_CLIENTE
ORDER BY PEDIDO.VALOR_TOTAL DESC

DESAFIO 4
SELECT ID_PEDIDO,
VALOR_TOTAL,
DATA_EMISSAO,
(CASE WHEN DATA_CANCELAMENTO is not null then 'CANCELADO'
       WHEN DATA_FATURAMENTO is not null then 'FATURADO'
	    ELSE 'PENDENTE'END ) AS SITUACAO_PEDIDO
FROM pedido
order by ID_PEDIDO ASC

DESAFIO 5
SELECT ITEM.ID_PRODUTO,
       SUM(ITEM.QUANTIDADE) AS QUANTIDADE_VENDIDA,
	   SUM(ITEM.QUANTIDADE * PRECO_PRATICADO) AS TOTAL_VENDIDO,
	   COUNT(PEDIDO.ID_PEDIDO)AS PEDIDOS,
	   CLIENTES.QTD_CLIENTE
	   FROM ITENS_PEDIDO AS ITEM
LEFT JOIN PEDIDO
ON PEDIDO.ID_PEDIDO = ITEM.ID_PEDIDO
LEFT JOIN LATERAL
(SELECT COUNT(ID_CLIENTE)AS QTD_CLIENTE
FROM PEDIDO P
WHERE PEDIDO.ID_CLIENTE = P.ID_CLIENTE
LIMIT 1)CLIENTES ON TRUE
GROUP BY ITEM.ID_PRODUTO,
         CLIENTES.QTD_CLIENTE
         

ORDER BY TOTAL_VENDIDO DESC